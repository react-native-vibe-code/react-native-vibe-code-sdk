---
title: API Reference
description: Complete API endpoint reference for React Native Vibe Code - Internal and toolkit routes
---

# API Reference

Complete reference for all API endpoints in React Native Vibe Code. This includes both internal application routes and external toolkit endpoints.

## Base URLs

- **Production:** `https://reactnativevibecode.com`
- **Development:** `http://localhost:3210`
- **Sandbox:** `https://[sandbox-id].e2b.dev`

## Authentication

Most internal endpoints require authentication via Better Auth session cookies.

**Headers:**
```typescript
{
  'Cookie': 'better-auth.session_token=xxx',
  'Content-Type': 'application/json'
}
```

Toolkit endpoints (`/api/toolkit/*`) do not require authentication but support CORS for cross-origin requests.

---

## Toolkit Endpoints

External-facing APIs with CORS support for mobile apps and sandboxes.

### POST /api/toolkit/llm

Generate text completions using Claude AI.

**Request:**
```typescript
{
  messages: Array<{
    role: 'user' | 'assistant' | 'system';
    content: string;
  }>;
}
```

**Response:**
```typescript
{
  completion: string;
}
```

**Status Codes:**
- `200` - Success
- `400` - Invalid request
- `500` - Server error

**Max Duration:** 60s

---

### POST /api/toolkit/stt

Transcribe audio to text using OpenAI Whisper.

**Request:** `multipart/form-data`
```typescript
{
  audio: File;           // Audio file (max 25MB)
  language?: string;     // Optional language code
}
```

**Response:**
```typescript
{
  text: string;
  language: string;
}
```

**Status Codes:**
- `200` - Success
- `400` - Invalid file or too large
- `408` - Timeout
- `500` - Server error

**Max Duration:** 120s

---

### POST /api/toolkit/search

Search Google using SerpAPI.

**Request:**
```typescript
{
  query: string;         // Search query
  gl?: string;          // Geographic location (default: 'us')
  hl?: string;          // Language (default: 'en')
  num?: number;         // Number of results (default: 10)
}
```

**Response:**
```typescript
{
  searchMetadata: object;
  searchInformation: object;
  organicResults: Array<object>;
  knowledgeGraph?: object;
  relatedSearches?: Array<object>;
  localResults?: Array<object>;
  shoppingResults?: Array<object>;
}
```

**Max Duration:** 60s

---

### POST /api/toolkit/exa-search

Search for people using Exa.

**Request:**
```typescript
{
  query: string;
  numResults?: number;   // 1-100, default: 10
}
```

**Response:**
```typescript
{
  results: Array<object>;
  requestId: string;
}
```

**Max Duration:** 60s

---

### POST /api/toolkit/images

Generate images using DALL-E 3.

**Request:**
```typescript
{
  prompt: string;
  size?: '1024x1024' | '1792x1024' | '1024x1792';
}
```

**Response:**
```typescript
{
  image: {
    base64Data: string;
    mimeType: 'image/png';
  };
  size: string;
}
```

**Max Duration:** 60s

---

## Chat & AI Endpoints

### POST /api/chat

Main chat endpoint for AI-powered code generation.

**Authentication:** Required

**Request:**
```typescript
{
  messages: UIMessage[];
  projectId: string;
  userId: string;
  claudeModel?: string;
  fileEdition?: string;
  selectionData?: any;
  imageAttachments?: Array<{
    url: string;
    contentType: string;
    name: string;
    size: number;
  }>;
  skills?: string[];
}
```

**Response:** Streaming AI SDK response

**Features:**
- Rate limiting per user
- Usage tracking
- Message history
- Image support
- Skills integration

**Max Duration:** 800s (13 minutes)

**File:** `app/(app)/api/chat/route.ts`

---

### POST /api/transcribe

Transcribe audio for voice chat.

**Authentication:** Required

**Request:** `multipart/form-data`
```typescript
{
  audio: File;  // Max 25MB
}
```

**Response:**
```typescript
{
  text: string;
  duration?: number;
  language?: string;
}
```

**Max Duration:** 120s

**File:** `app/(app)/api/transcribe/route.ts`

---

## Project Management

### GET /api/projects

List user's projects.

**Authentication:** Required

**Query Parameters:**
```typescript
{
  status?: 'active' | 'deleted';
  limit?: number;
  offset?: number;
}
```

**Response:**
```typescript
{
  projects: Array<{
    id: string;
    name: string;
    description: string;
    userId: string;
    sandboxId?: string;
    template: string;
    visibility: 'private' | 'public';
    status: 'active' | 'deleted';
    createdAt: string;
    updatedAt: string;
  }>;
  total: number;
}
```

---

### POST /api/projects

Create a new project.

**Authentication:** Required

**Request:**
```typescript
{
  name: string;
  description?: string;
  template?: 'expo-template' | 'tamagui-template' | 'github-template';
  visibility?: 'private' | 'public';
}
```

**Response:**
```typescript
{
  project: {
    id: string;
    name: string;
    // ... other fields
  };
}
```

---

### GET /api/projects/[id]

Get project details.

**Authentication:** Required

**Response:**
```typescript
{
  project: {
    id: string;
    name: string;
    description: string;
    sandboxId: string;
    template: string;
    visibility: string;
    status: string;
    createdAt: string;
    updatedAt: string;
    messages: Array<{
      id: string;
      role: string;
      content: string;
      createdAt: string;
    }>;
  };
}
```

---

### PATCH /api/projects/[id]

Update project details.

**Authentication:** Required

**Request:**
```typescript
{
  name?: string;
  description?: string;
  visibility?: 'private' | 'public';
}
```

**Response:**
```typescript
{
  project: object;
}
```

---

### DELETE /api/projects/[id]

Soft delete a project.

**Authentication:** Required

**Response:**
```typescript
{
  success: boolean;
}
```

---

### PATCH /api/projects/[id]/visibility

Change project visibility.

**Authentication:** Required

**Request:**
```typescript
{
  visibility: 'private' | 'public';
}
```

**Response:**
```typescript
{
  project: object;
}
```

---

### POST /api/projects/[id]/remix

Fork/remix a public project.

**Authentication:** Required

**Response:**
```typescript
{
  project: {
    id: string;
    name: string;
    // ... new project details
  };
}
```

---

## Sandbox Management

### POST /api/create-container

Create a new E2B sandbox for a project.

**Authentication:** Required

**Request:**
```typescript
{
  projectId: string;
  template?: string;
  userId: string;
}
```

**Response:**
```typescript
{
  sandboxId: string;
  templateId: string;
  url: string;
}
```

**Max Duration:** 300s (5 minutes)

**File:** `app/(app)/api/create-container/route.ts`

---

### POST /api/recreate-container

Recreate a sandbox (e.g., after timeout).

**Authentication:** Required

**Request:**
```typescript
{
  projectId: string;
  userId: string;
}
```

**Response:**
```typescript
{
  sandboxId: string;
}
```

---

### GET /api/sandbox-status

Check sandbox health and status.

**Authentication:** Required

**Query Parameters:**
```typescript
{
  sandboxId: string;
}
```

**Response:**
```typescript
{
  status: 'running' | 'stopped' | 'error';
  uptime?: number;
  memory?: number;
  cpu?: number;
}
```

---

### POST /api/sandbox-structure

Get file tree structure of sandbox.

**Authentication:** Required

**Request:**
```typescript
{
  sandboxId: string;
  path?: string;
}
```

**Response:**
```typescript
{
  files: Array<{
    path: string;
    type: 'file' | 'directory';
    size?: number;
    modified?: string;
  }>;
}
```

---

### POST /api/sandbox/[sandboxId]/files/read

Read file from sandbox.

**Authentication:** Required

**Request:**
```typescript
{
  path: string;
}
```

**Response:**
```typescript
{
  content: string;
  encoding: 'utf-8' | 'base64';
}
```

---

### POST /api/sandbox/[sandboxId]/files/write

Write file to sandbox.

**Authentication:** Required

**Request:**
```typescript
{
  path: string;
  content: string;
}
```

**Response:**
```typescript
{
  success: boolean;
}
```

---

### POST /api/sandbox/[sandboxId]/files/delete

Delete file from sandbox.

**Authentication:** Required

**Request:**
```typescript
{
  path: string;
}
```

**Response:**
```typescript
{
  success: boolean;
}
```

---

## File Operations

### POST /api/file-changes

Subscribe to file change notifications via Pusher.

**Authentication:** Required

**Request:**
```typescript
{
  projectId: string;
  sandboxId: string;
}
```

**Response:**
```typescript
{
  channelName: string;  // Pusher channel name
}
```

---

### POST /api/file-watch

Start watching sandbox files for changes.

**Authentication:** Required

**Request:**
```typescript
{
  sandboxId: string;
  projectId: string;
}
```

**Response:**
```typescript
{
  watching: boolean;
}
```

---

## Server Management

### POST /api/start-server

Start Expo development server in sandbox.

**Authentication:** Required

**Request:**
```typescript
{
  sandboxId: string;
  port?: number;  // Default: 8081
}
```

**Response:**
```typescript
{
  started: boolean;
  url: string;
  qrCode?: string;
}
```

---

### POST /api/restart-server

Restart Expo server.

**Authentication:** Required

**Request:**
```typescript
{
  sandboxId: string;
}
```

**Response:**
```typescript
{
  restarted: boolean;
}
```

---

### GET /api/server-status

Check if Expo server is running.

**Authentication:** Required

**Query Parameters:**
```typescript
{
  sandboxId: string;
}
```

**Response:**
```typescript
{
  running: boolean;
  port?: number;
  url?: string;
}
```

---

### GET /api/check-expo-server

Verify Expo server health.

**Authentication:** Required

**Query Parameters:**
```typescript
{
  sandboxId: string;
}
```

**Response:**
```typescript
{
  healthy: boolean;
  expoVersion?: string;
}
```

**File:** `app/(app)/api/check-expo-server/route.ts`

---

## Authentication Endpoints

### POST /api/auth/sign-in

Sign in with credentials.

**Request:**
```typescript
{
  email: string;
  password: string;
}
```

**Response:**
```typescript
{
  user: object;
  session: object;
}
```

---

### POST /api/auth/sign-out

Sign out current session.

**Response:**
```typescript
{
  success: boolean;
}
```

---

### GET /api/auth/session

Get current session.

**Response:**
```typescript
{
  user: {
    id: string;
    name: string;
    email: string;
    image?: string;
  };
  session: {
    id: string;
    expiresAt: string;
  };
} | null
```

---

## Subscription Endpoints

### GET /api/subscription

Get user's subscription details.

**Authentication:** Required

**Response:**
```typescript
{
  subscription: {
    tier: 'free' | 'start' | 'pro' | 'senior';
    status: 'active' | 'canceled' | 'past_due';
    currentPeriodEnd: string;
    cancelAtPeriodEnd: boolean;
  };
  usage: {
    messageCount: number;
    messageLimit: number;
    projectCount: number;
    projectLimit: number;
  };
}
```

---

### POST /api/subscription/checkout

Create checkout session for subscription upgrade.

**Authentication:** Required

**Request:**
```typescript
{
  tier: 'start' | 'pro' | 'senior';
}
```

**Response:**
```typescript
{
  checkoutUrl: string;
}
```

---

## Pusher Real-time

### POST /api/pusher/auth

Authenticate Pusher private channels.

**Authentication:** Required

**Request:**
```typescript
{
  socket_id: string;
  channel_name: string;
}
```

**Response:**
```typescript
{
  auth: string;
  channel_data?: string;
}
```

---

## Polar Integration

### POST /api/polar/webhook

Handle Polar webhook events for subscription updates.

**Request:** Polar webhook payload

**Response:**
```typescript
{
  received: boolean;
}
```

**File:** `app/(app)/api/polar/webhook/route.ts`

---

## Debug Endpoints

Development and debugging endpoints (not available in production).

### GET /api/debug/subscription

Debug subscription state.

**Authentication:** Required

**Response:**
```typescript
{
  userId: string;
  subscription: object;
  usage: object;
  polarData: object;
}
```

---

### GET /api/debug/check-better-auth

Verify Better Auth configuration.

**Response:**
```typescript
{
  configured: boolean;
  providers: string[];
  database: boolean;
}
```

---

## Mobile App Endpoints

Endpoints for mobile app integration.

### GET /api/mobile/projects

Get projects formatted for mobile app.

**Authentication:** Required

**Response:**
```typescript
{
  projects: Array<{
    id: string;
    name: string;
    description: string;
    thumbnailUrl?: string;
    lastModified: string;
  }>;
}
```

---

## Error Responses

All endpoints follow a consistent error format:

```typescript
{
  error: string;              // Human-readable message
  code?: string;              // Error code
  details?: any;              // Additional context
}
```

**Common Status Codes:**
- `400` - Bad Request (invalid parameters)
- `401` - Unauthorized (not authenticated)
- `403` - Forbidden (not authorized)
- `404` - Not Found
- `408` - Request Timeout
- `429` - Too Many Requests (rate limited)
- `500` - Internal Server Error
- `503` - Service Unavailable

---

## Rate Limiting

Endpoints are rate-limited based on:

1. **User Subscription Tier** - Higher tiers have higher limits
2. **Endpoint Type** - Different limits for different operations
3. **Time Window** - Typically per month or per hour

**Rate Limit Headers:**
```typescript
{
  'X-RateLimit-Limit': '100',
  'X-RateLimit-Remaining': '95',
  'X-RateLimit-Reset': '1234567890'
}
```

---

## CORS Configuration

Toolkit endpoints support CORS with dynamic origin validation:

**Allowed Origins:**
- `https://reactnativevibecode.com`
- `http://localhost:*`
- `*.e2b.dev`
- `*.pages.dev`
- `*.capsulethis.app`
- `exp://*` (Expo Go)
- `capsule://*` (Deep links)

**CORS Headers:**
```typescript
{
  'Access-Control-Allow-Origin': '<origin>',
  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, PATCH, OPTIONS',
  'Access-Control-Allow-Headers': 'Content-Type, Authorization, Cookie',
  'Access-Control-Allow-Credentials': 'true',
  'Access-Control-Max-Age': '86400'
}
```

**File:** `lib/cors.ts`

---

## Webhooks

### Polar Webhooks

**Endpoint:** `POST /api/polar/webhook`

**Events:**
- `subscription.created`
- `subscription.updated`
- `subscription.canceled`
- `checkout.created`
- `checkout.completed`

**Signature Verification:** Required

---

## SDK Usage Examples

### JavaScript/TypeScript

```typescript
// Chat API
const response = await fetch('https://reactnativevibecode.com/api/chat', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Cookie': `better-auth.session_token=${sessionToken}`
  },
  body: JSON.stringify({
    messages: [{
      id: 'msg_1',
      role: 'user',
      content: 'Create a todo app'
    }],
    projectId: 'proj_123',
    userId: 'user_456'
  })
})

const reader = response.body.getReader()
// Process streaming response
```

### React Native

```typescript
import { useChat } from 'ai/react'

function ChatScreen({ projectId, userId }) {
  const { messages, input, handleInputChange, handleSubmit } = useChat({
    api: 'https://reactnativevibecode.com/api/chat',
    body: { projectId, userId }
  })

  return (
    <View>
      {messages.map(m => (
        <Text key={m.id}>{m.content}</Text>
      ))}
      <TextInput
        value={input}
        onChangeText={handleInputChange}
      />
      <Button title="Send" onPress={handleSubmit} />
    </View>
  )
}
```

### cURL

```bash
# Create project
curl -X POST https://reactnativevibecode.com/api/projects \
  -H "Content-Type: application/json" \
  -H "Cookie: better-auth.session_token=xxx" \
  -d '{
    "name": "My Todo App",
    "template": "expo-template"
  }'

# Transcribe audio
curl -X POST https://reactnativevibecode.com/api/toolkit/stt \
  -F "audio=@recording.wav" \
  -F "language=en"

# Generate image
curl -X POST https://reactnativevibecode.com/api/toolkit/images \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "A beautiful sunset",
    "size": "1024x1024"
  }'
```

---

## Environment Variables

Required environment variables for API functionality:

```bash
# Core
DATABASE_URL=postgresql://...
BETTER_AUTH_SECRET=xxx

# AI Services
ANTHROPIC_API_KEY=sk-ant-xxx
OPENAI_API_KEY=sk-xxx

# Sandboxes
E2B_API_KEY=xxx

# Search
SERP_API_KEY=xxx
EXA_API_KEY=xxx

# Real-time
PUSHER_APP_ID=xxx
PUSHER_KEY=xxx
PUSHER_SECRET=xxx
PUSHER_CLUSTER=xxx

# Subscriptions
POLAR_ACCESS_TOKEN=xxx
POLAR_ORGANIZATION_ID=xxx
```

---

## Versioning

Current API version: **v1** (implicit, no version in URL)

Future versions will be prefixed: `/api/v2/...`

---

## Support & Resources

- **Documentation:** https://docs.reactnativevibecode.com
- **API Status:** https://status.reactnativevibecode.com
- **GitHub:** https://github.com/capsule-org/capsule-ide
- **Discord:** https://discord.gg/capsule

---

## Related Documentation

- [API Integration](/api-integration) - Detailed toolkit endpoint guide
- [AI SDK Integration](/ai-sdk-integration) - AI SDK 5.0 usage
- [Voice Chat](/voice-chat) - Voice input integration
- [Features](/features) - Complete feature overview
